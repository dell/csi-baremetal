apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web2
spec:
  serviceName: "nginx"
  replicas: 6
  podManagementPolicy: Parallel
  selector:
    matchLabels:
      app: nginx2
  template:
    metadata:
      labels:
        app: nginx2
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                  - key: app
                    operator: In
                    values:
                      - nginx2
              topologyKey: "kubernetes.io/hostname"
      containers:
        - name: nginx
          image: k8s.gcr.io/nginx-slim:0.8
          ports:
            - containerPort: 80
              name: web
          volumeMounts:
            - name: www
              mountPath: /usr/share/nginx/html
            - name: www1
              mountPath: /usr/share/nginx/html1
  volumeClaimTemplates:
    - metadata:
        name: www
      spec:
        storageClassName: csi-baremetal-sc-hddlvg
        accessModes: [ "ReadWriteOnce" ]
        resources:
          requests:
            storage: 20M
    - metadata:
        name: www1
      spec:
        storageClassName: csi-baremetal-sc-hddlvg
        accessModes: [ "ReadWriteOnce" ]
        resources:
          requests:
            storage: 20M
